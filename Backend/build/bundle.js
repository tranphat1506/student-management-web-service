/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t={867:t=>{var e=["http://127.0.0.1:5500","http://localhost:3000","http://localhost"],r={origin:function(t,r){-1===e.indexOf(t)&&t?r(new Error("Not allowed by CORS")):r(null,!0)},credentials:!0,optionsSuccessStatus:200,allowedHeaders:["Content-Type","Authorization"]};t.exports={normalCorsOptions:r}},2:(t,e,r)=>{var n=r(185),o=process.env.DB_CONNECT_STRING,a=process.env.DB_NAME;t.exports=(n.set("strictQuery",!0),n.connect(o,{dbName:a,useNewUrlParser:!0,useUnifiedTopology:!0}))},175:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){"use strict";o=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),s=new S(n||[]);return a(i,"_invoke",{value:_(t,r,s)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=p;var f={};function d(){}function y(){}function g(){}var m={};l(m,s,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(O([])));b&&b!==e&&r.call(b,s)&&(m=b);var x=g.prototype=d.prototype=Object.create(m);function w(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function o(a,i,s,c){var u=h(t[a],t,i);if("throw"!==u.type){var l=u.arg,p=l.value;return p&&"object"==n(p)&&r.call(p,"__await")?e.resolve(p.__await).then((function(t){o("next",t,s,c)}),(function(t){o("throw",t,s,c)})):e.resolve(p).then((function(t){l.value=t,s(l)}),(function(t){return o("throw",t,s,c)}))}c(u.arg)}var i;a(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function _(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return{value:void 0,done:!0}}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var s=L(i,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=h(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function L(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,L(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var a=o.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function O(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return y.prototype=g,a(x,"constructor",{value:g,configurable:!0}),a(g,"constructor",{value:y,configurable:!0}),y.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},w(k.prototype),l(k.prototype,c,(function(){return this})),t.AsyncIterator=k,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new k(p(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},w(x),l(x,u,"Generator"),l(x,s,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=O,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:O(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function a(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function i(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function s(t){a(i,n,o,s,c,"next",t)}function c(t){a(i,n,o,s,c,"throw",t)}s(void 0)}))}}var s=r(828).v4,c=r(783),u=r(936),l=r(709).UserModel,p=r(55).logEvents,h={},f={},d=6e5,y=function(){var t=i(o().mark((function t(e,r){var n,a,i,f,y,g,m;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.headers.authorization||e.cookies.a_token){t.next=2;break}return t.abrupt("return",r.status(401).json({message:"Unauthorized!"}));case 2:return t.prev=2,n=e.cookies.a_token||e.headers.authorization.split(" ")[1],a=u.getPayload(n),t.next=7,l.findOne({id:a.id});case 7:if(i=t.sent,f=i.account_details.email,y=s(),g=(new Date).getTime(),f.details||f.isVerify){t.next=13;break}return t.abrupt("return",r.status(403).json({message:"Email was NOT in whitelist or NOT verify yet!"}));case 13:if(h[f.details]){t.next=17;break}h[f.details]={code:y,turns:4,last_get:g},t.next=23;break;case 17:if(!(g-h[f.details].last_get<d)){t.next=20;break}return m=Math.round((d-(g-h[f.details].last_get))/1e3),t.abrupt("return",r.status(403).json({time_left:m,message:"Please wait ".concat(m,"s to get next verification code!")}));case 20:h[f.details].last_get=g,h[f.details].code=y,h[f.details].turns=4;case 23:return t.next=26,c.sendMail("gmail",f.details,"Test","<h1>".concat(y,"<h1>"));case 26:return t.abrupt("return",r.status(200).json({message:"Verification code was sent to your email!"}));case 27:return console.log("IP: ".concat(e.socket.remoteAddress)),console.log("CODE : ".concat(y)),t.abrupt("return",r.status(200).json({message:"Verification code was sent to your email!"}));case 32:return t.prev=32,t.t0=t.catch(2),p("".concat(t.t0.name,": ").concat(t.t0.message),"errors"),t.abrupt("return",r.status(500).json({message:"Hệ thống đang bận!"}));case 36:case"end":return t.stop()}}),t,null,[[2,32]])})));return function(e,r){return t.apply(this,arguments)}}(),g=function(){var t=i(o().mark((function t(e,r){var n,a,i,s,c,y,g;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.body.code){t.next=3;break}return t.abrupt("return",r.status(403).json({message:"Verification code should not be empty!"}));case 3:return t.prev=3,a=e.cookies.a_token||e.headers.authorization.split(" ")[1],i=u.getPayload(a),t.next=8,l.findOne({id:i.id});case 8:if(s=t.sent,(c=s.account_details.email).details||c.isVerify){t.next=12;break}return t.abrupt("return",r.status(403).json({message:"Email was NOT in whitelist or NOT verify yet!"}));case 12:if(h[c.details]){t.next=14;break}return t.abrupt("return",r.status(403).json({message:"Can not found email info in list!"}));case 14:if(h[c.details].turns){t.next=18;break}return y=(new Date).getTime(),g=Math.round((d-(y-h[c.details].last_get))/1e3),t.abrupt("return",r.status(400).json({message:"Enter the wrong verification code too many times, please wait ".concat(g,"s and get new code!")}));case 18:if(h[c.details].code===n){t.next=22;break}return h[c.details].turns-=1,h[c.details].last_get=(new Date).getTime(),t.abrupt("return",r.status(403).json({message:"Verification code doesn't match, you only have ".concat(h[c.details].turns," entries left")}));case 22:return r.cookie("adminLogin",n,{secure:!0}),f[n]={email:c.details,time_access:new Date},delete h[c.details],t.abrupt("return",r.status(200).json({message:"Success login to admin page!"}));case 28:return t.prev=28,t.t0=t.catch(3),p("".concat(t.t0.name,": ").concat(t.t0.message),"errors"),t.abrupt("return",r.status(500).json({message:"Hệ thống đang bận!"}));case 32:case"end":return t.stop()}}),t,null,[[3,28]])})));return function(e,r){return t.apply(this,arguments)}}();t.exports={sendCode:y,verifyCode:g,verifyCodeInList:function(t,e){var r=t.body.code;return f[r]?e.status(200).json({code:200,message:"OK"}):e.status(404).json({code:404,message:"Code was wrong or delete by Admin!"})},authCheck:function(t,e){return e.status(200).json({code:200,message:"OK"})}}},922:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){"use strict";o=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),s=new S(n||[]);return a(i,"_invoke",{value:_(t,r,s)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=p;var f={};function d(){}function y(){}function g(){}var m={};l(m,s,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(O([])));b&&b!==e&&r.call(b,s)&&(m=b);var x=g.prototype=d.prototype=Object.create(m);function w(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function o(a,i,s,c){var u=h(t[a],t,i);if("throw"!==u.type){var l=u.arg,p=l.value;return p&&"object"==n(p)&&r.call(p,"__await")?e.resolve(p.__await).then((function(t){o("next",t,s,c)}),(function(t){o("throw",t,s,c)})):e.resolve(p).then((function(t){l.value=t,s(l)}),(function(t){return o("throw",t,s,c)}))}c(u.arg)}var i;a(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function _(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return{value:void 0,done:!0}}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var s=L(i,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=h(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function L(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,L(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var a=o.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function O(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return y.prototype=g,a(x,"constructor",{value:g,configurable:!0}),a(g,"constructor",{value:y,configurable:!0}),y.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},w(k.prototype),l(k.prototype,c,(function(){return this})),t.AsyncIterator=k,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new k(p(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},w(x),l(x,u,"Generator"),l(x,s,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=O,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:O(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function a(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function i(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function s(t){a(i,n,o,s,c,"next",t)}function c(t){a(i,n,o,s,c,"throw",t)}s(void 0)}))}}var s=r(936),c=r(681),u=r(709).UserModel,l=r(798),p=r(828).v4,h=r(55).logEvents,f=process.env.ACCESS_TOKEN_SECRET,d=process.env.REFRESH_TOKEN_SECRET,y=process.env.ACCESS_TOKEN_LIFE,g=process.env.REFRESH_TOKEN_LIFE,m=r(96),v=r(792).roleDisplay,b=function(){var t=i(o().mark((function t(e,r){var n,a,l,p,v;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.body,a=n.user_name,l=n.password,p=n.remember_pwd,t.prev=1,t.next=4,u.findOne({"account_details.user_name":a});case 4:if(v=t.sent,!c.isNull(v)){t.next=7;break}return t.abrupt("return",r.status(400).json({message:"Tài khoản hoặc mật khẩu không hợp lệ!"}));case 7:if(v.account_details.email.isVerify||v.account_details.phone.isVerify){t.next=9;break}return t.abrupt("return",r.status(400).json({message:"Tài khoản này vẫn chưa xác thực!"}));case 9:return t.next=11,m.compare(l,v.account_details.password);case 11:if(t.sent){t.next=14;break}return t.abrupt("return",r.status(400).json({message:"Tài khoản hoặc mật khẩu không hợp lệ!"}));case 14:Promise.all([s.generateToken(v,f,y),s.generateToken(v,d,g)]).then(function(){var t=i(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!p){t.next=3;break}return r.cookie("a_token",e[0].encoded,{maxAge:36e5,sameSite:"none",httpOnly:!1,secure:!0}),t.abrupt("return",r.status(200).json({code:200,r_token:e[1].encoded}));case 3:return r.cookie("a_token",e[0].encoded,{sameSite:"none",httpOnly:!1,secure:!0}),t.abrupt("return",r.sendStatus(200));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=21;break;case 17:return t.prev=17,t.t0=t.catch(1),h("".concat(t.t0.name,": ").concat(t.t0.message),"errors"),t.abrupt("return",r.status(500).json({message:"Hệ thống đang bận!"}));case 21:case"end":return t.stop()}}),t,null,[[1,17]])})));return function(e,r){return t.apply(this,arguments)}}(),x=r(783),w=r(594),k={email:!0,phone:!1},_={fname:0,lname:1,dBirth:2,mBith:3,yBirth:4,role:5,sex:6,user_name:7,password:8,re_password:9,phone:10,email:11,method:12},L=function(){var t=i(o().mark((function t(e,r){var n,a,i,s,f,d,y,g,b,L,E,j,S,O,T,N,P,F,G,z,C,M,D;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.body,a=n.fname,i=n.lname,s=n.phone,f=n.email,d=n.user_name,y=n.password,g=n.re_password,b=n.method,L=n.dBirth,E=n.mBirth,j=n.yBirth,S=n.role,O=n.sex,L){t.next=3;break}return t.abrupt("return",r.status(400).json({message:"Vui lòng không bỏ trống ngày sinh!",type:_.dBirth}));case 3:if(E){t.next=5;break}return t.abrupt("return",r.status(400).json({message:"Vui lòng không bỏ trống tháng sinh!",type:_.mBirth}));case 5:if(j){t.next=7;break}return t.abrupt("return",r.status(400).json({message:"Vui lòng không bỏ trống năm sinh!",type:_.yBirth}));case 7:if(T=j%4==0&&j%100!=0||j%400==0,!(2==E&&L>28)){t.next=11;break}if(!(!T||L>29||L<1)){t.next=11;break}return t.abrupt("return",r.status(400).json({message:"Ngày ".concat(L," không có trong tháng ").concat(E,". Vui lòng kiểm tra lại!"),type:_.dBirth}));case 11:t.t0=E,t.next=4===t.t0||6===t.t0||9===t.t0||11===t.t0?14:16;break;case 14:if(!(L>30||L<1)){t.next=16;break}return t.abrupt("return",r.status(400).json({message:"Ngày ".concat(L," không có trong tháng ").concat(E,". Vui lòng kiểm tra lại!"),type:_.dBirth}));case 16:if(!(L>31||L<1)){t.next=18;break}return t.abrupt("return",r.status(400).json({message:"Ngày ".concat(L," không có trong tháng ").concat(E,". Vui lòng kiểm tra lại!"),type:_.dBirth}));case 18:if(!(N=l({fname:a,lname:i,birth:new Date(j+"-"+E+"-"+L).toISOString(),role:S,sex:O,user_name:d,password:y,re_password:g,phone:s,email:f,method:b}))){t.next=21;break}return t.abrupt("return",r.status(400).json({message:N.message,type:_[N.details[0].context.key]}));case 21:if(P=v(S)){t.next=24;break}return t.abrupt("return",r.status(400).json({message:'Vai trò "'.concat(S,'" không được hỗ trợ!'),type:_.role}));case 24:if(k[b]){t.next=26;break}return t.abrupt("return",r.status(400).json({message:"Phương thức xác thực bằng ".concat(b," chưa có!"),type:_.method}));case 26:return t.prev=26,t.next=29,m.hash(y,8);case 29:return F=t.sent,t.next=32,u.findOne({"account_details.user_name":d});case 32:if(G=t.sent,!c.isNull(G)){t.next=48;break}return t.next=36,p();case 36:if(z=t.sent,C=w.sendVerifyCode("http://localhost/home","http://localhost/auth?method=verify&token=".concat(z),d),"email"!=b){t.next=41;break}return t.next=41,x.sendMail("gmail",e.body[b],"Xác Thực Tài Khoản Mới",C);case 41:return t.next=43,p();case 43:return M=t.sent,D=new u({id:M,account_details:{user_name:d,password:F,email:{details:f},phone:{details:s},role:{display:P}},info_details:{fullname:{first_name:a,last_name:i},birth:{day:L,month:E,year:j},sex:{display:O?O>1?"Chưa cập nhật":"Nam":"Nữ",info:O}},temp_data:{email_verification_code:{expired_at:(new Date).getTime()+864e5,token:z}}}),t.next=47,D.save();case 47:return t.abrupt("return",r.status(200).json({message:"Đăng ký thành công!"}));case 48:return t.abrupt("return",r.status(400).json({message:"Người dùng đã tồn tại!",type:_.user_name}));case 51:return t.prev=51,t.t1=t.catch(26),h("".concat(t.t1.name,": ").concat(t.t1.message),"errors"),t.abrupt("return",r.status(503).json({code:503,message:"Hệ thống đang bận!"}));case 55:case"end":return t.stop()}}),t,null,[[26,51]])})));return function(e,r){return t.apply(this,arguments)}}(),E=function(){var t=i(o().mark((function t(e,r){var n,a,i,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.headers.authorization||e.cookies.r_token||e.body.r_token){t.next=2;break}return t.abrupt("return",r.status(403).json({code:403,message:"No token provided or token expired!"}));case 2:return t.prev=2,n=e.cookies.r_token||e.headers.authorization.split(" ")[1]||e.body.r_token,t.next=6,s.verifyToken(n,d);case 6:return a=t.sent,i=a.decoded,t.next=10,s.generateToken(i,f,y);case 10:return c=t.sent,r.cookie("a_token",c.encoded,{maxAge:36e5,sameSite:"none",httpOnly:!1,secure:!0}),t.abrupt("return",r.status(200).json({token:c.encoded}));case 15:return t.prev=15,t.t0=t.catch(2),h("".concat(t.t0.name,": ").concat(t.t0.message),"errors"),t.abrupt("return",r.status(503).json({code:503,message:"Hệ thống đang bận!"}));case 19:case"end":return t.stop()}}),t,null,[[2,15]])})));return function(e,r){return t.apply(this,arguments)}}(),j=function(){var t=i(o().mark((function t(e,r){var n,a,i,s;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.body&&e.body.token){t.next=3;break}return t.abrupt("return",r.status(400).json({code:400,message:"Bad Request."}));case 3:return t.prev=3,t.next=6,u.findOne({"temp_data.email_verification_code.token":n});case 6:if(a=t.sent){t.next=9;break}return t.abrupt("return",r.status(403).json({code:403,message:"The verification link has expired!"}));case 9:if(i=a.account_details.email.details,s=(new Date).getTime()-Number(a.temp_data.email_verification_code.expired_at)>0,!a.account_details.email.isVerify&&!s){t.next=13;break}return t.abrupt("return",r.status(403).json({code:403,message:"The verification link has expired!"}));case 13:return a.account_details.email.isVerify=!0,t.next=16,a.save();case 16:return t.abrupt("return",r.status(200).json({code:200,message:"OK!",user_email:i}));case 19:return t.prev=19,t.t0=t.catch(3),h("".concat(t.t0.name,": ").concat(t.t0.message),"errors"),t.abrupt("return",r.status(503).json({code:503,message:"Hệ thống đang bận!"}));case 23:case"end":return t.stop()}}),t,null,[[3,19]])})));return function(e,r){return t.apply(this,arguments)}}();t.exports={signIn:b,signUp:L,signOut:function(t,e){},emailVerify:j,refreshAccessToken:E,authCheck:function(t,e){if(!t.headers.authorization&&!t.cookies.a_token&&!t.body.a_token)return e.status(403).json({code:403,message:"No token provided or token expired!"});var r=t.cookies.a_token||t.headers.authorization.split(" ")[1]||t.body.a_token;s.verifyToken(r,f).then((function(){return e.status(200).json({code:200,message:"Welcome back user!"})})).catch((function(t){return h("".concat(t.name,": ").concat(t.message),"errors"),e.status(401).json({code:401,message:"No Authorized!"})}))}}},491:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){"use strict";o=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),s=new S(n||[]);return a(i,"_invoke",{value:_(t,r,s)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=p;var f={};function d(){}function y(){}function g(){}var m={};l(m,s,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(O([])));b&&b!==e&&r.call(b,s)&&(m=b);var x=g.prototype=d.prototype=Object.create(m);function w(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function o(a,i,s,c){var u=h(t[a],t,i);if("throw"!==u.type){var l=u.arg,p=l.value;return p&&"object"==n(p)&&r.call(p,"__await")?e.resolve(p.__await).then((function(t){o("next",t,s,c)}),(function(t){o("throw",t,s,c)})):e.resolve(p).then((function(t){l.value=t,s(l)}),(function(t){return o("throw",t,s,c)}))}c(u.arg)}var i;a(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function _(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return{value:void 0,done:!0}}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var s=L(i,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=h(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function L(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,L(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var a=o.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function O(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return y.prototype=g,a(x,"constructor",{value:g,configurable:!0}),a(g,"constructor",{value:y,configurable:!0}),y.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},w(k.prototype),l(k.prototype,c,(function(){return this})),t.AsyncIterator=k,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new k(p(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},w(x),l(x,u,"Generator"),l(x,s,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=O,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:O(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function a(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}var i=r(936).getPayload,s=r(726),c=function(){var t,e=(t=o().mark((function t(e,r){var n,a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=i(e.cookies.a_token||e.headers.authorization.split(" ")[1]).id,a=e.body&&e.body.id||n,s.getUserDataFromID(n,a,!0).then((function(t){return r.status(200).json({user:t})})).catch((function(t){return logEvents("".concat(t.name,": ").concat(t.message),"errors"),r.status(403).json({message:t.message})}));case 3:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function s(t){a(i,n,o,s,c,"next",t)}function c(t){a(i,n,o,s,c,"throw",t)}s(void 0)}))});return function(t,r){return e.apply(this,arguments)}}();t.exports={getInfo:c}},594:t=>{t.exports={sendVerifyCode:function(t,e,r){return'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n    <html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office" style="font-family:arial, \'helvetica neue\', helvetica, sans-serif">\n     <head>\n      <meta charset="UTF-8">\n      <meta content="width=device-width, initial-scale=1" name="viewport">\n      <meta name="x-apple-disable-message-reformatting">\n      <meta http-equiv="X-UA-Compatible" content="IE=edge">\n      <meta content="telephone=no" name="format-detection">\n      <title>New message 2</title>\x3c!--[if (mso 16)]>\n        <style type="text/css">\n        a {text-decoration: none;}\n        </style>\n        <![endif]--\x3e\x3c!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]--\x3e\x3c!--[if gte mso 9]>\n    <xml>\n        <o:OfficeDocumentSettings>\n        <o:AllowPNG></o:AllowPNG>\n        <o:PixelsPerInch>96</o:PixelsPerInch>\n        </o:OfficeDocumentSettings>\n    </xml>\n    <![endif]--\x3e\x3c!--[if !mso]>\x3c!-- --\x3e\n      <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">\x3c!--<![endif]--\x3e\n      <style type="text/css">\n    #outlook a {\n      padding:0;\n    }\n    .es-button {\n      mso-style-priority:100!important;\n      text-decoration:none!important;\n    }\n    a[x-apple-data-detectors] {\n      color:inherit!important;\n      text-decoration:none!important;\n      font-size:inherit!important;\n      font-family:inherit!important;\n      font-weight:inherit!important;\n      line-height:inherit!important;\n    }\n    .es-desk-hidden {\n      display:none;\n      float:left;\n      overflow:hidden;\n      width:0;\n      max-height:0;\n      line-height:0;\n      mso-hide:all;\n    }\n    [data-ogsb] .es-button {\n      border-width:0!important;\n      padding:15px 35px 15px 35px!important;\n    }\n    @media only screen and (max-width:600px) {p, ul li, ol li, a { line-height:150%!important } h1, h2, h3, h1 a, h2 a, h3 a { line-height:120% } h1 { font-size:30px!important; text-align:center!important } h2 { font-size:24px!important; text-align:center!important } h3 { font-size:20px!important; text-align:center!important } .es-header-body h1 a, .es-content-body h1 a, .es-footer-body h1 a { font-size:30px!important; text-align:center!important } .es-header-body h2 a, .es-content-body h2 a, .es-footer-body h2 a { font-size:24px!important; text-align:center!important } .es-header-body h3 a, .es-content-body h3 a, .es-footer-body h3 a { font-size:20px!important; text-align:center!important } .es-menu td a { font-size:14px!important } .es-header-body p, .es-header-body ul li, .es-header-body ol li, .es-header-body a { font-size:14px!important } .es-content-body p, .es-content-body ul li, .es-content-body ol li, .es-content-body a { font-size:14px!important } .es-footer-body p, .es-footer-body ul li, .es-footer-body ol li, .es-footer-body a { font-size:14px!important } .es-infoblock p, .es-infoblock ul li, .es-infoblock ol li, .es-infoblock a { font-size:12px!important } *[class="gmail-fix"] { display:none!important } .es-m-txt-c, .es-m-txt-c h1, .es-m-txt-c h2, .es-m-txt-c h3 { text-align:center!important } .es-m-txt-r, .es-m-txt-r h1, .es-m-txt-r h2, .es-m-txt-r h3 { text-align:right!important } .es-m-txt-l, .es-m-txt-l h1, .es-m-txt-l h2, .es-m-txt-l h3 { text-align:left!important } .es-m-txt-r img, .es-m-txt-c img, .es-m-txt-l img { display:inline!important } .es-button-border { display:inline-block!important } a.es-button, button.es-button { font-size:18px!important; display:inline-block!important } .es-adaptive table, .es-left, .es-right { width:100%!important } .es-content table, .es-header table, .es-footer table, .es-content, .es-footer, .es-header { width:100%!important; max-width:600px!important } .es-adapt-td { display:block!important; width:100%!important } .adapt-img { width:100%!important; height:auto!important } .es-m-p0 { padding:0px!important } .es-m-p0r { padding-right:0px!important } .es-m-p0l { padding-left:0px!important } .es-m-p0t { padding-top:0px!important } .es-m-p0b { padding-bottom:0!important } .es-m-p20b { padding-bottom:20px!important } .es-mobile-hidden, .es-hidden { display:none!important } tr.es-desk-hidden, td.es-desk-hidden, table.es-desk-hidden { width:auto!important; overflow:visible!important; float:none!important; max-height:inherit!important; line-height:inherit!important } tr.es-desk-hidden { display:table-row!important } table.es-desk-hidden { display:table!important } td.es-desk-menu-hidden { display:table-cell!important } .es-menu td { width:1%!important } table.es-table-not-adapt, .esd-block-html table { width:auto!important } table.es-social { display:inline-block!important } table.es-social td { display:inline-block!important } .es-desk-hidden { display:table-row!important; width:auto!important; overflow:visible!important; max-height:inherit!important } }\n    </style>\n     </head>\n     <body style="width:100%;font-family:arial, \'helvetica neue\', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0">\n      <div class="es-wrapper-color" style="background-color:#FFFFFF">\x3c!--[if gte mso 9]>\n          <v:background xmlns:v="urn:schemas-microsoft-com:vml" fill="t">\n            <v:fill type="tile" color="#ffffff"></v:fill>\n          </v:background>\n        <![endif]--\x3e\n       <table class="es-wrapper" width="100%" cellspacing="0" cellpadding="0" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;padding:0;Margin:0;width:100%;height:100%;background-repeat:repeat;background-position:center top;background-color:#FFFFFF">\n         <tr>\n          <td valign="top" style="padding:0;Margin:0">\n           <table cellpadding="0" cellspacing="0" class="es-header" align="center" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top">\n             <tr>\n              <td align="center" style="padding:0;Margin:0">\n               <table bgcolor="#fad939" class="es-header-body" align="center" cellpadding="0" cellspacing="0" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:510px">\n                 <tr>\n                  <td align="left" style="padding:0;Margin:0;padding-left:20px;padding-right:20px">\n                   <table cellpadding="0" cellspacing="0" width="100%" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px">\n                     <tr>\n                      <td align="center" valign="top" style="padding:0;Margin:0;width:470px">\n                       <table cellpadding="0" cellspacing="0" width="100%" role="presentation" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px">\n                         <tr>\n                          <td align="center" height="40" style="padding:0;Margin:0"></td>\n                         </tr>\n                       </table></td>\n                     </tr>\n                   </table></td>\n                 </tr>\n               </table></td>\n             </tr>\n           </table>\n           <table class="es-content" cellspacing="0" cellpadding="0" align="center" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%">\n             <tr>\n              <td align="center" style="padding:0;Margin:0">\n               <table class="es-content-body" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:transparent;width:510px" cellspacing="0" cellpadding="0" align="center" bgcolor="#FAD939">\n                 <tr>\n                  <td align="left" style="padding:0;Margin:0">\n                   <table width="100%" cellspacing="0" cellpadding="0" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px">\n                     <tr>\n                      <td class="es-m-p0r" valign="top" align="center" style="padding:0;Margin:0;width:510px">\n                       <table width="100%" cellspacing="0" cellpadding="0" role="presentation" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px">\n                         <tr>\n                          <td align="center" style="padding:0;Margin:0;position:relative"><a target="_blank" href="'.concat(t,'" style="-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#5D541D;font-size:18px"><img class="adapt-img" src="https://gfnugv.stripocdn.email/content/guids/bannerImgGuid/images/image16770588540601854.png" alt title width="510" style="display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic"></a></td>\n                         </tr>\n                       </table></td>\n                     </tr>\n                   </table></td>\n                 </tr>\n               </table></td>\n             </tr>\n           </table>\n           <table cellpadding="0" cellspacing="0" class="es-content" align="center" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%">\n             <tr>\n              <td align="center" style="padding:0;Margin:0">\n               <table bgcolor="#fad939" class="es-content-body" align="center" cellpadding="0" cellspacing="0" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#fad939;border-radius:0px 0px 50px 50px;width:510px">\n                 <tr>\n                  <td align="left" style="padding:0;Margin:0;padding-left:20px;padding-right:20px">\n                   <table cellpadding="0" cellspacing="0" width="100%" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px">\n                     <tr>\n                      <td align="center" valign="top" style="padding:0;Margin:0;width:470px">\n                       <table cellpadding="0" cellspacing="0" width="100%" role="presentation" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px">\n                         <tr>\n                          <td align="center" style="padding:0;Margin:0"><h1 style="Margin:0;line-height:46px;mso-line-height-rule:exactly;font-family:tahoma, verdana, segoe, sans-serif;font-size:38px;font-style:normal;font-weight:bold;color:#5D541D">Hãy xác nhận email của bạn!</h1></td>\n                         </tr>\n                         <tr>\n                          <td align="center" style="padding:0;Margin:0;padding-top:40px;padding-bottom:40px"><h3 style="Margin:0;line-height:24px;mso-line-height-rule:exactly;font-family:tahoma, verdana, segoe, sans-serif;font-size:20px;font-style:normal;font-weight:bold;color:#5D541D">Cảm ơn ').concat(r,' đã đăng ký ;O; !</h3><p style="Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:tahoma, verdana, segoe, sans-serif;line-height:27px;color:#5D541D;font-size:18px"><br></p><p style="Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:tahoma, verdana, segoe, sans-serif;line-height:27px;color:#5D541D;font-size:18px">Hoàn thành bước cuối cùng, hãy xác nhận đây là email của bạn. Để chúng tôi xác nhận đây là chính tài khoản của bạn. Bạn có thể bỏ qua hoặc xóa bức thư này.</p></td>\n                         </tr>\n                         <tr>\n                          <td align="center" style="padding:0;Margin:0">\x3c!--[if mso]><a href="$verify_link}" target="_blank" hidden>\n      <v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" esdevVmlButton href="$verify_link}" \n                    style="height:48px; v-text-anchor:middle; width:232px" arcsize="50%" stroke="f"  fillcolor="#8bc34a">\n        <w:anchorlock></w:anchorlock>\n        <center style=\'color:#ffffff; font-family:Poppins, sans-serif; font-size:16px; font-weight:400; line-height:16px;  mso-text-raise:1px\'>Xác nhận email này!</center>\n      </v:roundrect></a>\n    <![endif]--\x3e\x3c!--[if !mso]>\x3c!-- --\x3e<span class="msohide es-button-border" style="border-style:solid;border-color:#2CB543;background:#8bc34a;border-width:0px;display:inline-block;border-radius:30px;width:auto;mso-hide:all"><a href="').concat(e,'" class="es-button" target="_blank" style="mso-style-priority:100 !important;text-decoration:none;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;color:#FFFFFF;font-size:16px;border-style:solid;border-color:#8bc34a;border-width:15px 35px 15px 35px;display:inline-block;background:#8bc34a;border-radius:30px;font-family:Poppins, sans-serif;font-weight:normal;font-style:normal;line-height:19px;width:auto;text-align:center">Xác nhận email này!</a></span>\x3c!--<![endif]--\x3e</td>\n                         </tr>\n                       </table></td>\n                     </tr>\n                   </table></td>\n                 </tr>\n                 <tr>\n                  <td align="left" style="Margin:0;padding-top:20px;padding-left:20px;padding-right:20px;padding-bottom:40px">\n                   <table cellpadding="0" cellspacing="0" width="100%" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px">\n                     <tr>\n                      <td align="left" style="padding:0;Margin:0;width:470px">\n                       <table cellpadding="0" cellspacing="0" width="100%" role="presentation" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px">\n                         <tr>\n                          <td align="center" style="padding:0;Margin:0"><p style="Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Poppins, sans-serif;line-height:21px;color:#5D541D;font-size:14px">Cảm ơn,<br>;O;&nbsp;Team!&nbsp;</p></td>\n                         </tr>\n                       </table></td>\n                     </tr>\n                   </table></td>\n                 </tr>\n               </table></td>\n             </tr>\n           </table>\n           <table cellpadding="0" cellspacing="0" class="es-header" align="center" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top">\n             <tr>\n              <td align="center" style="padding:0;Margin:0">\n               <table bgcolor="#fad939" class="es-header-body" align="center" cellpadding="0" cellspacing="0" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:510px">\n                 <tr>\n                  <td align="left" style="padding:0;Margin:0;padding-left:20px;padding-right:20px">\n                   <table cellpadding="0" cellspacing="0" width="100%" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px">\n                     <tr>\n                      <td align="center" valign="top" style="padding:0;Margin:0;width:470px">\n                       <table cellpadding="0" cellspacing="0" width="100%" role="presentation" style="mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px">\n                         <tr>\n                          <td align="center" height="40" style="padding:0;Margin:0"></td>\n                         </tr>\n                       </table></td>\n                     </tr>\n                   </table></td>\n                 </tr>\n               </table></td>\n             </tr>\n           </table></td>\n         </tr>\n       </table>\n      </div>\n     </body>\n    </html>')}}},936:(t,e,r)=>{var n=r(344);t.exports={verifyToken:function(t,e){return new Promise((function(r,o){n.verify(t,e,(function(t,e){return t?o(t):r({status:"success",decoded:e})}))}))},generateToken:function(t,e,r){var o={id:t.id};return new Promise((function(t,a){n.sign(o,e,{expiresIn:r,algorithm:"HS256"},(function(e,r){return e?a(e):t({status:"success",encoded:r})}))}))},getPayload:function(t){return n.decode(t,{json:!0})}}},783:(t,e,r)=>{var n=r(184),o=process.env.GMAIL,a=process.env.GMAIL_PASSWORD,i=function(t,e,r){return{service:t,auth:{user:e,pass:r}}};t.exports={createConfig:i,sendMail:function(t,e){var r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";"gmail"==t&&(r=i(t,o,a));var u=n.createTransport(r),l={from:r.auth.user,to:e,subject:s,html:c};return u.sendMail(l)}}},792:t=>{t.exports={roleDisplay:function(t){switch(t){case"hoc-sinh":return"Học sinh";case"giao-vien":return"Giáo viên";case"to-chuc-giao-duc":return"Tổ chức giáo dục";case"phu-huynh":return"Phụ huynh";default:return}}}},798:(t,e,r)=>{var n=r(506),o=new Date("1905-1-1").toISOString(),a=new Date(Date.now()-315569259747).toISOString(),i=/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/,s=/(\+84|0)+([0-9]{9})\b/,c=" ",u="không được để trống!",l="tối thiểu {{#limit}} ký tự!",p="không hợp lệ!",h="không được để trống!",f="Họ và tên đệm",d="Tên tài khoản",y="Mật khẩu",g="Mật khẩu nhập lại",m="Email",v="Số điện thoại",b="Tuổi của bạn",x="Giới tính",w="Vai trò của bạn",k="Phương thức xác thực",_=n.object({fname:n.string().required().messages({"string.empty":"Tên "+h,"any.required":"Tên "+u}),lname:n.string().min(6).required().messages({"string.empty":f+c+h,"any.required":f+c+u,"string.min":f+c+l}),birth:n.date().max(a).min(o).iso().required().messages({"date.empty":b+c+h,"any.required":b+c+u,"date.max":b+c+"phải tối thiểu là 11 tuổi!","date.min":b+c+p}),role:n.string().required().messages({"string.empty":w+c+h,"any.required":w+c+u}),sex:n.number().required().min(0).max(1).messages({"number.empty":x+c+h,"any.required":x+c+u,"number.min":x+c+p,"number.max":x+c+p}),user_name:n.string().min(6).max(32).pattern(/^(?!.*\.\.)(?!.*\.$)[^\W][\w.]{6,32}$/).messages({"string.min":d+c+l,"string.empty":d+c+h,"string.max":d+c+"tối đa {{#limit}} ký tự!","string.pattern.base":d+c+p}),password:n.string().min(8).pattern(/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*-_]).{8,}$/).required().messages({"any.required":y+c+u,"string.min":y+c+l,"string.empty":y+c+h,"string.pattern.base":y+c+p}),re_password:n.string().equal(n.ref("password")).required().messages({"any.required":g+c+u,"string.empty":g+c+h,"any.only":g+c+"không trùng với mật khẩu vừa nhập!"}),phone:n.string().required().pattern(s).messages({"any.required":v+c+u,"string.pattern.base":v+c+p,"string.empty":v+c+h}),email:n.string().pattern(i).required().messages({"any.required":m+c+u,"string.empty":m+c+h,"string.pattern.base":m+c+p}),method:n.string().required().messages({"any.required":k+c+u,"string.empty":k+c+h})});n.object({email:n.string().pattern(i).messages({"string.empty":m+c+h,"string.pattern.base":m+c+p}),phone:n.string().pattern(s).messages({"string.pattern.base":v+c+p,"string.empty":v+c+h})}),t.exports=validation=function(t){var e=_.validate(t).error;if(e)return e}},979:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){"use strict";o=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),s=new S(n||[]);return a(i,"_invoke",{value:_(t,r,s)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=p;var f={};function d(){}function y(){}function g(){}var m={};l(m,s,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(O([])));b&&b!==e&&r.call(b,s)&&(m=b);var x=g.prototype=d.prototype=Object.create(m);function w(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function o(a,i,s,c){var u=h(t[a],t,i);if("throw"!==u.type){var l=u.arg,p=l.value;return p&&"object"==n(p)&&r.call(p,"__await")?e.resolve(p.__await).then((function(t){o("next",t,s,c)}),(function(t){o("throw",t,s,c)})):e.resolve(p).then((function(t){l.value=t,s(l)}),(function(t){return o("throw",t,s,c)}))}c(u.arg)}var i;a(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function _(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return{value:void 0,done:!0}}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var s=L(i,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=h(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function L(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,L(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var a=o.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function O(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return y.prototype=g,a(x,"constructor",{value:g,configurable:!0}),a(g,"constructor",{value:y,configurable:!0}),y.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},w(k.prototype),l(k.prototype,c,(function(){return this})),t.AsyncIterator=k,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new k(p(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},w(x),l(x,u,"Generator"),l(x,s,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=O,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:O(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function a(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}var i=r(936),s=(r(681),r(55).logEvents),c=process.env.ACCESS_TOKEN_SECRET,u=(process.env.REFRESH_TOKEN_SECRET,function(){var t,e=(t=o().mark((function t(e,r,n){var a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.headers.authorization||e.cookies.a_token){t.next=2;break}return t.abrupt("return",r.status(401).json({message:"No token provided or token expired!"}));case 2:return t.prev=2,a=e.cookies.a_token||e.headers.authorization.split(" ")[1],t.next=6,i.verifyToken(a,c);case 6:t.sent.decoded,n(),t.next=15;break;case 11:return t.prev=11,t.t0=t.catch(2),s("".concat(t.t0.name,": ").concat(t.t0.message),"errors"),t.abrupt("return",r.status(401).json({message:"No token provided or token expired!"}));case 15:case"end":return t.stop()}}),t,null,[[2,11]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function s(t){a(i,n,o,s,c,"next",t)}function c(t){a(i,n,o,s,c,"throw",t)}s(void 0)}))});return function(t,r,n){return e.apply(this,arguments)}}());t.exports={verifyToken:u}},55:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){"use strict";o=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),s=new S(n||[]);return a(i,"_invoke",{value:_(t,r,s)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=p;var f={};function d(){}function y(){}function g(){}var m={};l(m,s,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(O([])));b&&b!==e&&r.call(b,s)&&(m=b);var x=g.prototype=d.prototype=Object.create(m);function w(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function o(a,i,s,c){var u=h(t[a],t,i);if("throw"!==u.type){var l=u.arg,p=l.value;return p&&"object"==n(p)&&r.call(p,"__await")?e.resolve(p.__await).then((function(t){o("next",t,s,c)}),(function(t){o("throw",t,s,c)})):e.resolve(p).then((function(t){l.value=t,s(l)}),(function(t){return o("throw",t,s,c)}))}c(u.arg)}var i;a(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function _(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return{value:void 0,done:!0}}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var s=L(i,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=h(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function L(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,L(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var a=o.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function O(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return y.prototype=g,a(x,"constructor",{value:g,configurable:!0}),a(g,"constructor",{value:y,configurable:!0}),y.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},w(k.prototype),l(k.prototype,c,(function(){return this})),t.AsyncIterator=k,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new k(p(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},w(x),l(x,u,"Generator"),l(x,s,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=O,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:O(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function a(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}var i=r(146).format,s=r(828).v4,c=r(147),u=r(147).promises,l=r(17),p=r(564).vi,h=function(){var t,e=(t=o().mark((function t(e,r){var n,a,h;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="".concat(i(new Date,"dd-MM-yyyy")),a="".concat(n).concat(i(new Date,"\tHH:mm:ss O",{locale:p})),h="".concat(a,"\t").concat(s(),"\t").concat(e,"\n"),t.prev=3,c.existsSync(l.join(__dirname,"../..","logs",r))){t.next=7;break}return t.next=7,u.mkdir(l.join(__dirname,"../..","logs",r));case 7:return t.next=9,u.appendFile(l.join(__dirname,"../..","logs",r,n+".txt"),h);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[3,11]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function s(t){a(i,n,o,s,c,"next",t)}function c(t){a(i,n,o,s,c,"throw",t)}s(void 0)}))});return function(t,r){return e.apply(this,arguments)}}();t.exports={reqHandle:function(t,e,r){h("".concat(t.method,"\t").concat(t.headers.origin||"localhost","\t").concat(t.url),"requests"),r()},errorHandle:function(t,e,r,n){h("".concat(e.method,"\t").concat(e.headers.origin||"localhost","\t").concat(e.url,"\t").concat(t.name,": ").concat(t.message),"errors"),r.status(500).json("".concat(t.name,": ").concat(t.message))},logEvents:h}},40:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){"use strict";o=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),s=new S(n||[]);return a(i,"_invoke",{value:_(t,r,s)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=p;var f={};function d(){}function y(){}function g(){}var m={};l(m,s,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(O([])));b&&b!==e&&r.call(b,s)&&(m=b);var x=g.prototype=d.prototype=Object.create(m);function w(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function o(a,i,s,c){var u=h(t[a],t,i);if("throw"!==u.type){var l=u.arg,p=l.value;return p&&"object"==n(p)&&r.call(p,"__await")?e.resolve(p.__await).then((function(t){o("next",t,s,c)}),(function(t){o("throw",t,s,c)})):e.resolve(p).then((function(t){l.value=t,s(l)}),(function(t){return o("throw",t,s,c)}))}c(u.arg)}var i;a(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function _(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return{value:void 0,done:!0}}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var s=L(i,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=h(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function L(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,L(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var a=o.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function O(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return y.prototype=g,a(x,"constructor",{value:g,configurable:!0}),a(g,"constructor",{value:y,configurable:!0}),y.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},w(k.prototype),l(k.prototype,c,(function(){return this})),t.AsyncIterator=k,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new k(p(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},w(x),l(x,u,"Generator"),l(x,s,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=O,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:O(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function a(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}var i=r(936),s=r(709).UserModel,c=function(){var t,e=(t=o().mark((function t(e,r,n){var a,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.cookies.a_token||e.headers.authorization.split(" ")[1],c=i.getPayload(a),t.next=5,s.findOne({id:c.id});case 5:if("admin"===t.sent.account_details.role.info){t.next=8;break}return t.abrupt("return",r.status(403).json({code:403,message:"No permission!"}));case 8:n(),t.next=15;break;case 11:return t.prev=11,t.t0=t.catch(0),console.log("".concat(t.t0.name,": ").concat(t.t0.message)),t.abrupt("return",r.status(500).json({code:500,message:"Hệ thống đang bận!"}));case 15:case"end":return t.stop()}}),t,null,[[0,11]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function s(t){a(i,n,o,s,c,"next",t)}function c(t){a(i,n,o,s,c,"throw",t)}s(void 0)}))});return function(t,r,n){return e.apply(this,arguments)}}();t.exports={adminRole:c}},709:(t,e,r)=>{var n=r(185),o=new n.Schema({id:String,account_details:{user_name:String,password:String,role:{info:{type:String,default:"client"},display:{type:String,default:"Chưa cập nhật"}},email:{isVerify:{type:Boolean,default:!1},details:{type:String,default:"Chưa cập nhật"}},phone:{isVerify:{type:Boolean,default:!1},details:{type:String,default:"Chưa cập nhật"}},created_at:{type:String,default:(new Date).toISOString()}},info_details:{display_name:{type:String,default:"Chưa cập nhật"},fullname:{first_name:String,last_name:String},birth:{day:Number,month:Number,year:Number},sex:{display:{type:String,default:"Chưa cập nhật"},info:Number},avatar_url:{type:String,default:"https://cdn141.picsart.com/357697367045201.jpg"}},temp_data:{email_verification_code:{expired_at:String,token:String}}}),a=n.model("Users",o);t.exports={UserModel:a}},283:(t,e,r)=>{var n=r(860).Router(),o=r(175);n.post("/isAdmin",o.authCheck),n.post("/send-code",o.sendCode),n.post("/verify-code",o.verifyCode),n.post("/verify-code-in-list",o.verifyCodeInList),t.exports=n},523:(t,e,r)=>{var n=r(860).Router(),o=r(526),a=r(979),i=r(40).adminRole,s=r(283),c=r(691);n.use("/auth",o),n.use(a.verifyToken),n.use("/admin",i,s),n.use("/user",c),t.exports=n},526:(t,e,r)=>{var n=r(860).Router(),o=r(922);n.get("/",(function(t,e){return e.sendStatus(200)})),n.post("/isLogin",o.authCheck),n.post("/refresh-token",o.refreshAccessToken),n.post("/signup",o.signUp),n.post("/signin",o.signIn),n.post("/verify-email",o.emailVerify),n.post("/logout",(function(t,e){return e.sendStatus(200)})),t.exports=n},412:(t,e,r)=>{var n=r(860).Router(),o=r(523);n.use("/api",o),n.post("/status",(function(t,e){return e.status(200).json({status:"OK",code:200,last_modified:_STATUS_TIME})})),n.all("*",(function(t,e){return e.sendStatus("404")})),t.exports=n},691:(t,e,r)=>{var n=r(860).Router(),o=r(491);n.post("/",o.getInfo),t.exports=n},726:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){"use strict";o=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),s=new S(n||[]);return a(i,"_invoke",{value:_(t,r,s)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=p;var f={};function d(){}function y(){}function g(){}var m={};l(m,s,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(O([])));b&&b!==e&&r.call(b,s)&&(m=b);var x=g.prototype=d.prototype=Object.create(m);function w(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function o(a,i,s,c){var u=h(t[a],t,i);if("throw"!==u.type){var l=u.arg,p=l.value;return p&&"object"==n(p)&&r.call(p,"__await")?e.resolve(p.__await).then((function(t){o("next",t,s,c)}),(function(t){o("throw",t,s,c)})):e.resolve(p).then((function(t){l.value=t,s(l)}),(function(t){return o("throw",t,s,c)}))}c(u.arg)}var i;a(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function _(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return{value:void 0,done:!0}}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var s=L(i,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=h(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function L(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,L(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var a=o.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function O(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return y.prototype=g,a(x,"constructor",{value:g,configurable:!0}),a(g,"constructor",{value:y,configurable:!0}),y.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},w(k.prototype),l(k.prototype,c,(function(){return this})),t.AsyncIterator=k,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new k(p(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},w(x),l(x,u,"Generator"),l(x,s,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=O,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:O(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function a(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}var i=r(709).UserModel,s=function(){var t,e=(t=o().mark((function t(e,r){var n,a=arguments;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.length>2&&void 0!==a[2]&&a[2],t.abrupt("return",new Promise((function(t,o){if(!n)return o({name:"ERROR_CODE_403",status:403,message:"No permission!"});i.findOne({idToGet:r}).then((function(n){if(e===r)return t({status:200,message:{fullname:n.info_details.fullname,display_name:n.info_details.display_name,sex:n.info_details.sex.display,birth:n.info_details.birth,avt_url:n.info_details.avatar_url,phone:n.account_details.phone,email:n.account_details.email,user_name:n.account_details.user_name,role:n.account_details.role.display}})})).catch((function(e){return t(e)}))})));case 2:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function s(t){a(i,n,o,s,c,"next",t)}function c(t){a(i,n,o,s,c,"throw",t)}s(void 0)}))});return function(t,r){return e.apply(this,arguments)}}();t.exports={getUserDataFromID:s}},96:t=>{"use strict";t.exports=require("bcrypt")},986:t=>{"use strict";t.exports=require("body-parser")},710:t=>{"use strict";t.exports=require("cookie-parser")},582:t=>{"use strict";t.exports=require("cors")},146:t=>{"use strict";t.exports=require("date-fns")},564:t=>{"use strict";t.exports=require("date-fns/locale")},142:t=>{"use strict";t.exports=require("dotenv")},860:t=>{"use strict";t.exports=require("express")},806:t=>{"use strict";t.exports=require("helmet")},506:t=>{"use strict";t.exports=require("joi")},344:t=>{"use strict";t.exports=require("jsonwebtoken")},185:t=>{"use strict";t.exports=require("mongoose")},184:t=>{"use strict";t.exports=require("nodemailer")},681:t=>{"use strict";t.exports=require("underscore")},828:t=>{"use strict";t.exports=require("uuid")},147:t=>{"use strict";t.exports=require("fs")},685:t=>{"use strict";t.exports=require("http")},17:t=>{"use strict";t.exports=require("path")}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,r),a.exports}(()=>{r(142).config();var t=process.env.PORT||3e3,e=(process.env.URL,new Date(Date.now()+252e5).toUTCString());global._STATUS_TIME=e;var n=r(860)(),o=r(685).createServer(n),a=r(986);n.use(a.urlencoded({extended:!1})),n.use(a.json());var i=r(710);n.use(i("abc")),n.set("trust proxy",1);var s=r(806);n.use(s());var c=r(582),u=r(867).normalCorsOptions;n.use(c(u)),n.use((function(t,e,r){return e.setHeader("Cache-Control","no-cache, no-store, must-revalidate"),r()}));var l=r(55),p=l.reqHandle,h=l.errorHandle,f=l.logEvents;n.use(p),n.use(h);var d=r(412);n.use(d),o.listen(t,(function(){f("Server run on PORT ".concat(t),"server"),console.log("Server run on PORT ".concat(t))})),r(2).catch((function(t){f("".concat(t.name,": ").concat(t.message),"errors"),console.log("".concat(t.name,": ").concat(t.message)),o.close()})).then((function(){f("Connect DB SUCCESS!","server"),console.log("Connect DB SUCCESS!")}))})()})();